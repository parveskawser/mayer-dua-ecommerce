document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".confirm-toggle").forEach(c=>{c.addEventListener("change",function(){const t=this,o=t.getAttribute("data-id"),n=t.checked,s=document.getElementById(`status-badge-${o}`),a=t.nextElementSibling;a.textContent=n?"Yes":"No";const i=new URLSearchParams;i.append("id",o),i.append("isConfirmed",n);const d=document.querySelector('input[name="__RequestVerificationToken"]')?.value;fetch("/SalesOrder/ToggleConfirmation",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",RequestVerificationToken:d},body:i.toString()}).then(e=>e.json()).then(e=>{e.success?s&&(s.textContent=e.newStatus,e.newStatus==="Confirmed"?s.className="badge bg-success text-white":e.newStatus==="Pending"?s.className="badge bg-warning text-dark":s.className="badge bg-secondary-subtle text-dark"):r(t,a,!n,e.message)}).catch(e=>{console.error("Error:",e),r(t,a,!n,"Connection failed.")})})});function r(c,t,o,n){c.checked=o,t.textContent=o?"Yes":"No",alert("Action failed: "+n)}});
